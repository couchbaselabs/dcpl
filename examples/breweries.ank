# DCP events exposed as variable 'event'
# of the following type.
#
#   type Event struct {
#     Type  string
#     Key   string
#     Value []byte
#   }
#

json = import("encoding/json")
func filter(event) {
  if event.Type != "mutation" {
     return true
  }

  val = ""
  err = json.Unmarshal(event.Value, &val)
  if err != nil {
     return true
  }
  return val.item_type == "brewery"
}

# the script should return boolean
filter(event)
